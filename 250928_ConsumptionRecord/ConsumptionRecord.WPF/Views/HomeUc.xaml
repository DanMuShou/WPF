<UserControl
  x:Class="ConsumptionRecord.WPF.Views.HomeUc"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:cvt="clr-namespace:ConsumptionRecord.WPF.Converter"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:prism="http://prismlibrary.com/"
  xmlns:ui="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:vm="clr-namespace:ConsumptionRecord.WPF.ViewModels"
  d:DataContext="{d:DesignInstance Type=vm:HomeUcViewModel}"
  d:DesignHeight="500"
  d:DesignWidth="900"
  prism:ViewModelLocator.AutoWireViewModel="True"
  mc:Ignorable="d"
>
  <UserControl.Resources>
    <cvt:TimeToChineseConverter x:Key="WeekConverter" />
  </UserControl.Resources>
  <Grid Margin="16,8">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition />
    </Grid.RowDefinitions>
    <!--  ROW1 标头  -->
    <TextBlock Grid.Row="0">
      <Run FontSize="24" Text="您好, " />
      <Run FontSize="24" Text="{Binding CurrentTime, Converter={StaticResource WeekConverter}}" />
    </TextBlock>
    <!--  ROW2 卡片  -->
    <ItemsControl Grid.Row="1" Margin="-8,16,-8,0" ItemsSource="{Binding StatePanelInfos}">
      <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
          <UniformGrid Columns="4" />
        </ItemsPanelTemplate>
      </ItemsControl.ItemsPanel>
      <ItemsControl.ItemTemplate>
        <DataTemplate>
          <Border Margin="8,0" Background="{Binding BackColor}" CornerRadius="10,10,0,10">
            <Border.Style>
              <Style TargetType="Border">
                <Setter Property="RenderTransform">
                  <Setter.Value>
                    <TranslateTransform />
                  </Setter.Value>
                </Setter>
                <Style.Triggers>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Effect">
                      <Setter.Value>
                        <DropShadowEffect BlurRadius="8" ShadowDepth="1" Color="#999999" />
                      </Setter.Value>
                    </Setter>
                    <Trigger.EnterActions>
                      <BeginStoryboard>
                        <Storyboard>
                          <DoubleAnimation
                            Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                            To="-5"
                            Duration="0:0:0.2"
                          />
                        </Storyboard>
                      </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                      <BeginStoryboard>
                        <Storyboard>
                          <DoubleAnimation
                            Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                            To="0"
                            Duration="0:0:0.2"
                          />
                        </Storyboard>
                      </BeginStoryboard>
                    </Trigger.ExitActions>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </Border.Style>
            <Grid>
              <StackPanel Margin="16,8">
                <ui:PackIcon Width="32" Height="32" Kind="{Binding Icon}" />
                <TextBlock Margin="0,8,0,16" FontSize="14" Text="{Binding Title}" />
                <TextBlock Margin="0,8" FontSize="32" Text="{Binding Result}" />
              </StackPanel>
              <Canvas ClipToBounds="True">
                <Ellipse
                  Canvas.Top="10"
                  Canvas.Right="-50"
                  Width="120"
                  Height="120"
                  Fill="White"
                  Opacity="0.1"
                />
                <Ellipse
                  Canvas.Top="80"
                  Canvas.Right="-30"
                  Width="120"
                  Height="120"
                  Fill="White"
                  Opacity="0.1"
                />
              </Canvas>
            </Grid>
          </Border>
        </DataTemplate>
      </ItemsControl.ItemTemplate>
    </ItemsControl>
    <!--  ROW3 内容  -->
    <Grid Grid.Row="2" Margin="0,16">
      <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
      </Grid.ColumnDefinitions>
      <!--  ROW3-COL1 主记录  -->
      <Border Grid.Column="0" Margin="0,0,8,0" Background="#33999999" CornerRadius="8">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
          </Grid.RowDefinitions>
          <TextBlock Grid.Row="0" Margin="8,0" VerticalAlignment="Center" Text="消费记录" />
          <Button
            Grid.Row="0"
            Width="30"
            Height="30"
            Margin="4,4"
            HorizontalAlignment="Right"
            Style="{StaticResource MaterialDesignFloatingActionSecondaryButton}"
          >
            <ui:PackIcon Kind="Add" />
          </Button>
          <ListBox
            Grid.Row="1"
            Margin="0,4"
            HorizontalContentAlignment="Stretch"
            ItemsSource="{Binding WaitInfos}"
            ScrollViewer.HorizontalScrollBarVisibility="Hidden"
          >
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                  </Grid.ColumnDefinitions>
                  <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock FontSize="16" FontWeight="Bold" Text="{Binding Title}" />
                      <TextBlock
                        Margin="16,0"
                        VerticalAlignment="Center"
                        Text="{Binding Time, Converter={StaticResource WeekConverter}, ConverterParameter=YMD}"
                      />
                    </StackPanel>
                    <TextBlock Text="{Binding Content}" />
                  </StackPanel>
                  <ToggleButton Grid.Column="1" />
                </Grid>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </Grid>
      </Border>
      <!--  ROW3-COL2 备忘录  -->
      <Border Grid.Column="1" Margin="8,0,0,0" Background="#33999999" CornerRadius="8">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
          </Grid.RowDefinitions>
          <TextBlock Grid.Row="0" Margin="8,0" VerticalAlignment="Center" Text="备忘录" />
          <Button
            Grid.Row="0"
            Width="30"
            Height="30"
            Margin="4,4"
            HorizontalAlignment="Right"
            Style="{StaticResource MaterialDesignFloatingActionSecondaryButton}"
          >
            <ui:PackIcon Kind="Add" />
          </Button>
          <ListBox
            Grid.Row="1"
            Margin="0,4"
            HorizontalContentAlignment="Stretch"
            ItemsSource="{Binding MemoInfos}"
            ScrollViewer.HorizontalScrollBarVisibility="Hidden"
          >
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                  </Grid.ColumnDefinitions>
                  <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock FontSize="16" FontWeight="Bold" Text="{Binding Title}" />
                      <TextBlock
                        Margin="16,0"
                        VerticalAlignment="Center"
                        Text="{Binding Time, Converter={StaticResource WeekConverter}, ConverterParameter=YMD}"
                      />
                    </StackPanel>
                    <TextBlock Text="{Binding Content}" />
                  </StackPanel>
                  <ToggleButton Grid.Column="1" />
                </Grid>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </Grid>
      </Border>
    </Grid>
  </Grid>
</UserControl>
